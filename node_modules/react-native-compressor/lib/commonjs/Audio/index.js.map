{"version":3,"sources":["index.tsx"],"names":["NativeAudio","NativeModules","Compressor","Audio","compress","url","options","DEFAULT_COMPRESS_AUDIO_OPTIONS","checkUrlAndOptionsResult","isCorrect","message","mediaDetails","bitrate","i","AUDIO_BITRATE","length","quality","compress_audio","error"],"mappings":";;;;;;;AAAA;;AACA;;AAOA,MAAMA,WAAW,GAAGC,2BAAcC,UAAlC;AAEA,MAAMC,KAAgB,GAAG;AACvBC,EAAAA,QAAQ,EAAE,OAAOC,GAAP,EAAYC,OAAO,GAAGC,qCAAtB,KAAyD;AACjE,QAAI;AACF,YAAMC,wBAA2C,GAC/C,MAAM,+BAAmBH,GAAnB,EAAwBC,OAAxB,CADR;;AAEA,UAAI,CAACE,wBAAwB,CAACC,SAA9B,EAAyC;AACvC,cAAMD,wBAAwB,CAACE,OAA/B;AACD,OAFD,MAEO;AACL;AAEA;AACA;AACA,cAAMC,YAAiB,GAAG;AACxBC,UAAAA,OAAO,EAAE;AADe,SAA1B,CALK,CASL;;AACA,YAAIA,OAAY,GAAGL,sCAA+BK,OAAlD;;AAEA,YAAID,YAAY,IAAIA,YAAY,CAACC,OAAjC,EAA0C;AACxC;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,qBAAcC,MAAlC,EAA0CF,CAAC,EAA3C,EAA+C;AAC7C;AACA,gBAAIF,YAAY,CAACC,OAAb,GAAuBE,qBAAcD,CAAd,CAA3B,EAA6C;AAC3C,kBAAIA,CAAC,GAAG,CAAJ,GAAQC,qBAAcC,MAA1B,EAAkC;AAChC,oBAAIT,OAAO,CAACU,OAAR,KAAoB,KAAxB,EAA+BJ,OAAO,GAAGE,qBAAcD,CAAC,GAAG,CAAlB,CAAV,CAA/B,KACK,IAAIP,OAAO,CAACU,OAAR,KAAoB,QAAxB,EACHJ,OAAO,GAAGE,qBAAcD,CAAC,GAAG,CAAlB,CAAV,CADG,KAEAD,OAAO,GAAGE,qBAAcD,CAAd,CAAV;AACN,eALD,MAKO,IAAIA,CAAC,GAAG,CAAJ,GAAQC,qBAAcC,MAA1B,EAAkC;AACvC,oBAAIT,OAAO,CAACU,OAAR,KAAoB,KAAxB,EAA+BJ,OAAO,GAAGE,qBAAcD,CAAC,GAAG,CAAlB,CAAV,CAA/B,KACKD,OAAO,GAAGE,qBAAcD,CAAd,CAAV;AACN,eAHM,MAGAD,OAAO,GAAGE,qBAAcD,CAAd,CAAV;;AACP;AACD,aAb4C,CAe7C;;;AACA,gBACEF,YAAY,CAACC,OAAb,IAAwBE,qBAAcA,qBAAcC,MAAd,GAAuB,CAArC,CAD1B,EAEE;AACAH,cAAAA,OAAO,GAAGE,qBAAcA,qBAAcC,MAAd,GAAuB,CAArC,CAAV;AACA;AACD;AACF;AACF;;AAED,eAAOf,WAAW,CAACiB,cAAZ,CAA2BZ,GAA3B,EAAgC;AACrCO,UAAAA,OADqC;AAErCI,UAAAA,OAAO,EAAEV,OAAO,CAACU;AAFoB,SAAhC,CAAP;AAID;AACF,KAjDD,CAiDE,OAAOE,KAAP,EAAmB;AACnB,YAAMA,KAAK,CAACR,OAAZ;AACD;AACF;AAtDsB,CAAzB;eAyDeP,K","sourcesContent":["import { NativeModules } from 'react-native';\nimport {\n  AUDIO_BITRATE,\n  AudioType,\n  DEFAULT_COMPRESS_AUDIO_OPTIONS,\n  defaultResultType,\n  checkUrlAndOptions,\n} from '../utils';\nconst NativeAudio = NativeModules.Compressor;\n\nconst Audio: AudioType = {\n  compress: async (url, options = DEFAULT_COMPRESS_AUDIO_OPTIONS) => {\n    try {\n      const checkUrlAndOptionsResult: defaultResultType =\n        await checkUrlAndOptions(url, options);\n      if (!checkUrlAndOptionsResult.isCorrect) {\n        throw checkUrlAndOptionsResult.message;\n      } else {\n        // Get resulting output file path\n\n        // Get media details\n        // const mediaDetails: any = await getDetails(url).catch(() => null);\n        const mediaDetails: any = {\n          bitrate: 0,\n        };\n\n        // Initialize bitrate\n        let bitrate: any = DEFAULT_COMPRESS_AUDIO_OPTIONS.bitrate;\n\n        if (mediaDetails && mediaDetails.bitrate) {\n          // Check and return the appropriate bitrate according to quality expected\n          for (let i = 0; i < AUDIO_BITRATE.length; i++) {\n            // Check a particular bitrate to return its nearest lower according to quality\n            if (mediaDetails.bitrate > AUDIO_BITRATE[i]) {\n              if (i + 2 < AUDIO_BITRATE.length) {\n                if (options.quality === 'low') bitrate = AUDIO_BITRATE[i + 2];\n                else if (options.quality === 'medium')\n                  bitrate = AUDIO_BITRATE[i + 1];\n                else bitrate = AUDIO_BITRATE[i];\n              } else if (i + 1 < AUDIO_BITRATE.length) {\n                if (options.quality === 'low') bitrate = AUDIO_BITRATE[i + 1];\n                else bitrate = AUDIO_BITRATE[i];\n              } else bitrate = AUDIO_BITRATE[i];\n              break;\n            }\n\n            // Check if the matching bitrate is the last in the array\n            if (\n              mediaDetails.bitrate <= AUDIO_BITRATE[AUDIO_BITRATE.length - 1]\n            ) {\n              bitrate = AUDIO_BITRATE[AUDIO_BITRATE.length - 1];\n              break;\n            }\n          }\n        }\n\n        return NativeAudio.compress_audio(url, {\n          bitrate,\n          quality: options.quality,\n        });\n      }\n    } catch (error: any) {\n      throw error.message;\n    }\n  },\n};\n\nexport default Audio;\n"]}